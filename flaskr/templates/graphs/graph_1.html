{% extends "base.html" %}


{% block head %}

    <meta name="description" content="Une première page web">
    <meta name="keywords" content="HTML,exemple">
    <meta name="author" content="Jean Tartempion">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.bundle.min.js"></script>

{% endblock %}




{% block body_content %}

    <section class="main">
        <div class="grid-container">
		
            <h1 class="page-title">{{ titre }}</h1>
            
    		<div class="grid-x">
    			<div class="large-12 cell">
				
				    {% if 'mois' in titre %}
                        <a class="button large button-grey" href="/{{ cours }}">Défaut</a>
                    {% else %}
                        <a class="button large button-grey" href="/{{ cours }}/months">Par Mois</a>
		            {% endif %}
					
                    <form method="GET">
					<div class="grid-x align-middle" style="height:70px">
					    {% if size == 'default' %}
					    <div class="cell small-1 medium-1 large-1"><button type="submit" value="large" class="button button-darkred" name="size" id="large" />Agrandir</button></div>
						{% elif size == 'large' %}
						<div class="cell small-7 medium-4 large-1"><button type="submit" value="default" class="button button-darkred" name="size" id="large" />Diminuer</button></div>
						{% endif %}
                        <div><p class="form-label">From :</p></div>
                        <div class="cell small-7 medium-4 large-3"><input class="form-input" type="text" value="{{ form_min }}" name="min" /></div>
                        <div><p class="form-label">To :</p></div>
                        <div class="cell small-7 medium-4 large-3"><input class="form-input" type="text" value="{{ form_max }}" name="max" /></div>
						<div class="cell small-1 medium-1 large-1" align="center"><input type="submit" value="Valider" class="button button-darkred" /></div>
				    </div>
                    </form>
					
					{% if size == 'default' %}
                        <div class="callout post" style="padding-top: 0px;">
                            <canvas id="graphique"></canvas>
    			        </div>
					{% endif %}
					
    			</div>
				
				
				
    		</div>
    		
    	</div>
		
		{% if size == 'large' %}
		    <div class="callout post" style="padding-top: 0px;">
			    <canvas id="graphique"></canvas>
			</div>
	    {% endif %}
		
		<div class="grid-container">
		    <div class="grid-x grid-margin-x">
			    <div class="large-6 cell">
				    <a href="#">
				        <div class="callout post" style="padding-top: 0px;">
				            <canvas id="graphique1"></canvas>
				        </div>
					</a>
				</div>
				<div class="large-6 cell">
				    <a href="#">
				        <div class="callout post" style="padding-top: 0px;">
				            <canvas id="graphique2"></canvas>
				        </div>
					</a>
				</div>
			</div>
		</div>
		
		<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
		
    </section>
	{{unit}}
	<script>
		// Chart.defaults.global.elements.line.fill = false; ---> TO BE DELETED : remove fills (le "remplissage")
		
        // l'identifiant est celui du canevas
        var ctx = document.getElementById('graphique').getContext('2d');
        // création du graphique
        var myChart = new Chart(ctx, {
            type: '{{type}}',  // le type du graphique
            data: {  // les données
                
			    {% if labels %}
                    labels: {{ labels | safe }},
		        {% endif %}
			    		        
                datasets: [{
                    label: 'Soumissions',
                    backgroundColor: "#3e95cd",  // utiliser une liste si on veut plusieurs couleurs, ex: ["#3e95cd", "#8e5ea2","#3cba9f", ...]
                    borderColor: "#3e95cd",
                    fill: false,  // fill: false -> permet de ne pas remplir la zone sous la courbe
                    //data: {{ data | safe }} ---> TO BE DELETED
                    data: [
                        {% for i in range(data| length) %}  // correspond à: for i in range(len(data))
                            { x: "{{ dates[i] | safe }}", y: {{ data[i] | safe }} },  // affichez le code source de la page si vous ne voyez pas ce que ça fait
                        {% endfor %}
                    ]
                }, {
                    label: 'Soumissions valides',
                    backgroundColor: "#3cba9f",
                    borderColor: "#3cba9f",
                    data: [
                        {% for i in range(dataV| length) %}
                            { x: "{{ datesV[i] | safe }}", y: {{ dataV[i] | safe }} },
                        {% endfor %}
                    ]
                }]
            },
            options: {
                scales: {
                    xAxes: [{
                        type: 'time',
                        time: {
                            unit: '{{ unit }}',
							min: '{{ min }}',
							max: '{{ max }}'
                        }
                    }]
                }
            }
        });
    </script>
	
	<script>
		// Chart.defaults.global.elements.line.fill = false; ---> TO BE DELETED : remove fills (le "remplissage")
		
        // l'identifiant est celui du canevas
        var ctx = document.getElementById('graphique1').getContext('2d');
        // création du graphique
        var myChart = new Chart(ctx, {
            type: '{{type}}',  // le type du graphique
            data: {  // les données
                
			    {% if labels %}
                    labels: {{ labels | safe }},
		        {% endif %}
			    		        
                datasets: [{
                    label: 'Soumissions',
                    backgroundColor: "#3e95cd",  // utiliser une liste si on veut plusieurs couleurs, ex: ["#3e95cd", "#8e5ea2","#3cba9f", ...]
                    borderColor: "#3e95cd",
                    fill: false,  // fill: false -> permet de ne pas remplir la zone sous la courbe
                    //data: {{ data | safe }} ---> TO BE DELETED
                    data: [
                        {% for i in range(data| length) %}  // correspond à: for i in range(len(data))
                            { x: "{{ dates[i] | safe }}", y: {{ data[i] | safe }} },  // affichez le code source de la page si vous ne voyez pas ce que ça fait
                        {% endfor %}
                    ]
                }, {
                    label: 'Soumissions valides',
                    backgroundColor: "#3cba9f",
                    borderColor: "#3cba9f",
                    data: [
                        {% for i in range(dataV| length) %}
                            { x: "{{ datesV[i] | safe }}", y: {{ dataV[i] | safe }} },
                        {% endfor %}
                    ]
                }]
            },
            options: {
                scales: {
                    xAxes: [{
                        type: 'time',
                        time: {
                            unit: 'month'
                        }
                    }]
                }
            }
        });
    </script>
	
	<script>
		// Chart.defaults.global.elements.line.fill = false; ---> TO BE DELETED : remove fills (le "remplissage")
		
        // l'identifiant est celui du canevas
        var ctx = document.getElementById('graphique2').getContext('2d');
        // création du graphique
        var myChart = new Chart(ctx, {
            type: '{{type}}',  // le type du graphique
            data: {  // les données
                
			    {% if labels %}
                    labels: {{ labels | safe }},
		        {% endif %}
			    		        
                datasets: [{
                    label: 'Soumissions',
                    backgroundColor: "#3e95cd",  // utiliser une liste si on veut plusieurs couleurs, ex: ["#3e95cd", "#8e5ea2","#3cba9f", ...]
                    borderColor: "#3e95cd",
                    fill: false,  // fill: false -> permet de ne pas remplir la zone sous la courbe
                    //data: {{ data | safe }} ---> TO BE DELETED
                    data: [
                        {% for i in range(data| length) %}  // correspond à: for i in range(len(data))
                            { x: "{{ dates[i] | safe }}", y: {{ data[i] | safe }} },  // affichez le code source de la page si vous ne voyez pas ce que ça fait
                        {% endfor %}
                    ]
                }, {
                    label: 'Soumissions valides',
                    backgroundColor: "#3cba9f",
                    borderColor: "#3cba9f",
                    data: [
                        {% for i in range(dataV| length) %}
                            { x: "{{ datesV[i] | safe }}", y: {{ dataV[i] | safe }} },
                        {% endfor %}
                    ]
                }]
            },
            options: {
                scales: {
                    xAxes: [{
                        type: 'time',
                        time: {
                            unit: 'month'
                        }
                    }]
                }
            }
        });
    </script>

{% endblock %}